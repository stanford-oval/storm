# STORM UI Production Environment Configuration Template
# Copy this file to .env.production and update the values below
# Never commit actual secrets to version control!

# ============================================================
# APPLICATION ENVIRONMENT
# ============================================================
NODE_ENV=production
BUILD_TARGET=production

# Domain configuration
DOMAIN=storm-ui.com
STAGING_DOMAIN=staging.storm-ui.com

# ============================================================
# DATABASE CONFIGURATION
# ============================================================
# PostgreSQL Database
POSTGRES_DB=storm
POSTGRES_USER=storm
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# ============================================================
# REDIS CONFIGURATION
# ============================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}

# ============================================================
# VECTOR DATABASE (Qdrant)
# ============================================================
QDRANT_HOST=qdrant
QDRANT_PORT=6333
QDRANT_GRPC_PORT=6334
QDRANT_URL=http://${QDRANT_HOST}:${QDRANT_PORT}
# For external Qdrant service:
# QDRANT_API_KEY=your_qdrant_api_key_here

# ============================================================
# APPLICATION SECURITY
# ============================================================
# JWT Secret - Generate a strong random key
SECRET_KEY=CHANGE_ME_SUPER_SECRET_JWT_KEY_MINIMUM_32_CHARS
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# API Rate Limiting
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_BURST=200

# ============================================================
# BACKEND API CONFIGURATION
# ============================================================
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8000
API_PORT=${BACKEND_PORT}

# CORS Configuration
CORS_ORIGINS=https://storm-ui.com,https://www.storm-ui.com,https://staging.storm-ui.com

# Worker Configuration
MAX_WORKERS=4
WORKER_TIMEOUT=120
WORKER_CLASS=uvicorn.workers.UvicornWorker

# ============================================================
# FRONTEND CONFIGURATION
# ============================================================
FRONTEND_PORT=3000
NEXT_PUBLIC_API_URL=https://storm-ui.com/api
NEXT_PUBLIC_WS_URL=wss://storm-ui.com/ws

# Next.js Configuration
NEXT_TELEMETRY_DISABLED=1
NEXT_BUILD_STANDALONE=true

# ============================================================
# CELERY CONFIGURATION (Background Tasks)
# ============================================================
CELERY_BROKER_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/0
CELERY_RESULT_BACKEND=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/0
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=true
CELERY_TASK_ALWAYS_EAGER=false

# Worker Configuration
CELERY_WORKER_CONCURRENCY=2
CELERY_WORKER_LOG_LEVEL=info
CELERY_WORKER_PREFETCH_MULTIPLIER=4

# Task Configuration
CELERY_TASK_SOFT_TIME_LIMIT=300
CELERY_TASK_TIME_LIMIT=600
CELERY_TASK_MAX_RETRIES=3
CELERY_TASK_DEFAULT_RETRY_DELAY=60

# ============================================================
# MONITORING & FLOWER (Celery Monitoring)
# ============================================================
FLOWER_PORT=5555
FLOWER_USER=admin
FLOWER_PASSWORD=CHANGE_ME_FLOWER_PASSWORD
FLOWER_BASIC_AUTH=${FLOWER_USER}:${FLOWER_PASSWORD}

# ============================================================
# LANGUAGE MODEL CONFIGURATIONS
# ============================================================
# OpenAI Configuration
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_API_TYPE=openai
OPENAI_API_BASE=https://api.openai.com/v1
OPENAI_API_VERSION=2023-12-01-preview

# Azure OpenAI Configuration (if using Azure)
# AZURE_OPENAI_API_KEY=your_azure_openai_key
# AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
# AZURE_OPENAI_API_VERSION=2023-12-01-preview

# Anthropic Configuration
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# Google Configuration  
GOOGLE_API_KEY=your_google_api_key_here

# Mistral Configuration
MISTRAL_API_KEY=your_mistral_api_key_here

# ============================================================
# RETRIEVAL/SEARCH ENGINE CONFIGURATIONS  
# ============================================================
# Bing Search
BING_SEARCH_API_KEY=your_bing_search_api_key_here

# You.com Search
YDC_API_KEY=your_you_search_api_key_here

# Serper (Google Search API)
SERPER_API_KEY=your_serper_api_key_here

# Brave Search
BRAVE_API_KEY=your_brave_search_api_key_here

# Tavily Search
TAVILY_API_KEY=your_tavily_search_api_key_here

# DuckDuckGo (no API key required)
DUCKDUCKGO_ENABLED=true

# ============================================================
# NGINX & LOAD BALANCER CONFIGURATION
# ============================================================
HTTP_PORT=80
HTTPS_PORT=443
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024

# SSL Configuration
SSL_CERTIFICATE_PATH=/etc/ssl/certs/storm-ui.com.crt
SSL_CERTIFICATE_KEY_PATH=/etc/ssl/certs/storm-ui.com.key

# ============================================================
# LOGGING CONFIGURATION
# ============================================================
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE=/app/logs/storm-ui.log
LOG_MAX_SIZE=100MB
LOG_BACKUP_COUNT=5

# Sentry Configuration (Error Tracking)
# SENTRY_DSN=your_sentry_dsn_here
# SENTRY_ENVIRONMENT=production
# SENTRY_RELEASE=1.0.0

# ============================================================
# BACKUP CONFIGURATION
# ============================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=storm-ui-backups
BACKUP_S3_ACCESS_KEY=your_s3_access_key
BACKUP_S3_SECRET_KEY=your_s3_secret_key
BACKUP_S3_REGION=us-east-1

# ============================================================
# PERFORMANCE & OPTIMIZATION
# ============================================================
# Cache Configuration
CACHE_TTL=3600
CACHE_MAX_SIZE=1000

# File Upload Configuration
MAX_UPLOAD_SIZE=100MB
ALLOWED_EXTENSIONS=.txt,.pdf,.doc,.docx,.md

# Rate Limiting
RATE_LIMIT_STORAGE_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/1

# ============================================================
# DEVELOPMENT/TESTING OVERRIDES
# ============================================================
# Only set these in development/staging environments
# DEBUG=false
# TESTING=false
# PYTEST_TIMEOUT=300

# ============================================================
# DOCKER RESOURCE LIMITS
# ============================================================
# Memory limits (in MB)
POSTGRES_MEMORY_LIMIT=1024
REDIS_MEMORY_LIMIT=512
BACKEND_MEMORY_LIMIT=2048
FRONTEND_MEMORY_LIMIT=1024
WORKER_MEMORY_LIMIT=4096

# CPU limits (number of cores)
POSTGRES_CPU_LIMIT=1
REDIS_CPU_LIMIT=0.5
BACKEND_CPU_LIMIT=2
FRONTEND_CPU_LIMIT=1
WORKER_CPU_LIMIT=2

# ============================================================
# HEALTH CHECK CONFIGURATION
# ============================================================
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=40

# ============================================================
# DEPLOYMENT CONFIGURATION
# ============================================================
DEPLOYMENT_STRATEGY=rolling
ROLLBACK_ENABLED=true
BLUE_GREEN_DEPLOYMENT=false
CANARY_DEPLOYMENT=false
CANARY_TRAFFIC_PERCENTAGE=10

# CI/CD Configuration
CI_PIPELINE_URL=https://github.com/stanford-oval/storm/actions
DEPLOY_KEY_PATH=/opt/storm-ui/.ssh/deploy_key

# ============================================================
# SECURITY HEADERS & POLICIES
# ============================================================
# Content Security Policy
CSP_DEFAULT_SRC="'self'"
CSP_SCRIPT_SRC="'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net"
CSP_STYLE_SRC="'self' 'unsafe-inline' https://fonts.googleapis.com"
CSP_FONT_SRC="'self' https://fonts.gstatic.com"
CSP_IMG_SRC="'self' data: https:"
CSP_CONNECT_SRC="'self' ws: wss:"

# HSTS Configuration
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# ============================================================
# ANALYTICS & MONITORING
# ============================================================
# Application Performance Monitoring
# NEW_RELIC_LICENSE_KEY=your_new_relic_key
# NEW_RELIC_APP_NAME=storm-ui-production

# Analytics
# GOOGLE_ANALYTICS_ID=GA-XXXXXXXXX
# MIXPANEL_TOKEN=your_mixpanel_token

# Metrics & Observability
METRICS_ENABLED=true
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
GRAFANA_ENABLED=true
GRAFANA_PORT=3001

# ============================================================
# FEATURE FLAGS
# ============================================================
FEATURE_CO_STORM=true
FEATURE_CUSTOM_CORPUS=true
FEATURE_VECTOR_SEARCH=true
FEATURE_BATCH_PROCESSING=true
FEATURE_API_RATE_LIMITING=true
FEATURE_SOCIAL_LOGIN=false
FEATURE_REAL_TIME_COLLABORATION=true

# ============================================================
# EXTERNAL INTEGRATIONS
# ============================================================
# Webhook Configuration
WEBHOOK_ENABLED=true
WEBHOOK_SECRET=CHANGE_ME_WEBHOOK_SECRET
WEBHOOK_TIMEOUT=30

# Email Configuration (for notifications)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your_email@gmail.com
# SMTP_PASSWORD=your_app_password
# SMTP_TLS=true

# Slack Integration (for deployment notifications)
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
# SLACK_CHANNEL=#deployments

# ============================================================
# NOTES FOR DEPLOYMENT
# ============================================================
# 1. Replace all CHANGE_ME_* values with actual secure values
# 2. Generate strong passwords and keys using: openssl rand -base64 32
# 3. Set up proper SSL certificates for HTTPS
# 4. Configure monitoring and alerting
# 5. Set up regular backups
# 6. Review and update security headers
# 7. Configure log rotation and retention
# 8. Set up proper DNS records
# 9. Configure CDN if needed
# 10. Test disaster recovery procedures